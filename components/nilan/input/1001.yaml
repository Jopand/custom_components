text_sensor:
  - platform: modbus_controller
    modbus_controller_id: nilan_modbus_controller
    name: "Operation mode"
    id: nilan_actual_operation_mode
    register_type: read
    address: 1001
    lambda: !lambda |-
      uint16_t int_mode = (data[item->offset] << 8) + data[item->offset+1];
      ESP_LOGD("main","Parsed operation mode int : %d", int_mode);

      switch (int_mode) {
        case 0: return esphome::optional<std::string>("Off");
        case 1: return esphome::optional<std::string>("Heat");
        case 2: return esphome::optional<std::string>("Cool");
        case 3: return esphome::optional<std::string>("Auto");
        case 4: return esphome::optional<std::string>("Service");
        default: return esphome::optional<std::string>("Unknown");
      }